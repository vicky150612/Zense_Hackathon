<!DOCTYPE html>
<html>

<head>
    <title>Posts</title>
    <style>
        #createPostModal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.4);
        }

        .modal-content {
            background-color: #fefefe;
            margin: 15% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 80%;
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }

        .close:hover,
        .close:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }
    </style>
</head>

<body>
    <h1>Posts</h1>
    <button onclick="showModal()">Create New Post</button><br>
    <ul>
        {% for post in posts %}
        <li>{{ post["title"] }}: {{ post["content"] }} (by User {{ post["user_id"] }})
            <button>
                <a href="/post/{{ post['id'] }}">View</a>
            </button>
        </li>
        {% endfor %}

    </ul>

    <a href="/main_page">Back to Main Page</a>
    <!-- Modal for creating a new post -->
    <div id="createPostModal">
        <div class="modal-content">
            <span class="close" onclick="hideModal()">&times;</span>
            <h2>Create Post</h2>
            <form method="POST" action="/create_post/{{ user_id }}">
                <input type="text" name="title" placeholder="title" required><br>
                <label for="type">Type:</label>
                <select id="type" name="type">
                    <option value="text">Text</option>
                    <option value="photo">Photo</option>
                </select><br>
                <label for="content">Content:</label>
                <textarea id="content" name="content" required></textarea><br>
                <button type="submit">Post</button>
            </form>
        </div>
    </div>

    <!-- JavaScript to control modal visibility -->
    <script>
        function showModal() {
            document.getElementById('createPostModal').style.display = 'block';
        }
        function hideModal() {
            document.getElementById('createPostModal').style.display = 'none';
        }
        document.getElementById('createPostModal').addEventListener('click', function (event) {
            if (event.target == this) {
                hideModal();
            }
        });
    </script>

    <!-- Original Cloudflare script from posts.html -->
    <script>(function () { function c() { var b = a.contentDocument || a.contentWindow.document; if (b) { var d = b.createElement('script'); d.innerHTML = "window.__CF$cv$params={r:'92f943d0ce69adde',t:'MTc0NDUyOTQ5Ny4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);"; b.getElementsByTagName('head')[0].appendChild(d) } } if (document.body) { var a = document.createElement('iframe'); a.height = 1; a.width = 1; a.style.position = 'absolute'; a.style.top = 0; a.style.left = 0; a.style.border = 'none'; a.style.visibility = 'hidden'; document.body.appendChild(a); if ('loading' !== document.readyState) c(); else if (window.addEventListener) document.addEventListener('DOMContentLoaded', c); else { var e = document.onreadystatechange || function () { }; document.onreadystatechange = function (b) { e(b); 'loading' !== document.readyState && (document.onreadystatechange = e, c()) } } } })();</script>
</body>

</html>